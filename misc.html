<!DOCTYPE html>
<html lang="en">

<head>
<meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Misc Scripts</title>

<!-- prism.js -->
<link href="https://cdn.jsdelivr.net/npm/prismjs@1.25.0/themes/prism.css" rel="stylesheet"/>
<script src="https://cdn.jsdelivr.net/npm/prismjs@1.25.0/components/prism-core.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/prismjs@1.25.0/plugins/autoloader/prism-autoloader.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/prismjs@1.25.0/plugins/normalize-whitespace/prism-normalize-whitespace.js"></script>
<script src="https://cdn.jsdelivr.net/npm/prismjs@1.25.0/components/prism-r.js"></script>
<script src="https://cdn.jsdelivr.net/npm/prismjs@1.25.0/components/prism-stan.js"></script>

<!-- tailwindCSS -->
<script src="https://cdn.tailwindcss.com/3.0.0?plugins=forms@0.4.0,typography@0.5.0,aspect-ratio@0.4.0,line-clamp@0.3.0"></script>
<style type="text/tailwindcss">
        pre[class*="language-"] {
            @apply bg-white px-4 py-4 lg:py-2 m-0;
        }

        li.toc-dot:before {
            content: "";
            width: 16px;
            height: 16px;
            position: absolute;
            top: 0px;
            left: -10px;
            background: white;
            border: 2px solid #4c807b;
            box-shadow: 2px 2px 0px #c1dddb;
            border-radius: 50%;
        }
      </style>
</head>
<body>
  <div class="bg-[#fdf9f3] px-4 md:px-8">
    <div class="w-full max-w-[96rem] mx-auto min-h-screen">
      <div class="flex flex-col xl:gap-x-8 xl:flex-row">
        <script>/* 
Prism.plugins.NormalizeWhitespace.setDefaults({
    'remove-trailing': true, 
    'remove-indent': true, 
    'left-trim': true, 
    'right-trim': true
});
*/

window.onload = function(e){ 
// Display table of contents with menu button
document.getElementById("menu-x").onclick = function () {
    document.getElementById("toc").classList.toggle("hidden");
    document.getElementById("menu-hamburger").classList.toggle("hidden");
    document.getElementById("menu-x").classList.toggle("hidden");
};
document.getElementById("menu-hamburger").onclick = function () {
    document.getElementById("toc").classList.toggle("hidden");
    document.getElementById("menu-hamburger").classList.toggle("hidden");
    document.getElementById("menu-x").classList.toggle("hidden");
};
}</script>
        <div class="flex max-h-screen flex-col xl:px-2 w-full xl:w-[20rem] flex-shrink-0 sticky bg-[#fdf9f3] xl:h-screen top-0 pt-8 md:pt-16 pb-4">
          <div class="flex flex-row space-between items-center pb-4">
            <a class="flex-grow" href="index.html">
              <h1 class="text-3xl flex flex-row items-center gap-x-2 text-[#315450] tracking-wide">
                 Stata
                <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 text-[#315450]" fill="none" viewbox="0 0 24 24" stroke="currentColor">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 9l3 3m0 0l-3 3m3-3H8m13 0a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                </svg>
                 R
              </h1>
            </a>
            <div id="menu-button" class="xl:hidden cursor-pointer">
              <svg id="menu-hamburger" xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 text-[#315450]" fill="none" viewbox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
              </svg>
              <svg id="menu-x" xmlns="http://www.w3.org/2000/svg" class="hidden h-8 w-8 text-[#993b27]" fill="none" viewbox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
              </svg>
            </div>
          </div>
          <div id="toc" class="hidden flex-grow w-full bg-[#fdf9f3] sticky overflow-y-scroll xl:overflow-y-auto max-h-screen xl:block xl:relative">
            <div>
              <h1 class="text-2xl font-semibold tracking-tight mt-8 text-[#315450]">
                <a href="data_cleaning.html">data.table</a>
              </h1>
              <ul class="mt-4 relative">
                <li class="toc-dot flex flex-col relative border-l-2 border-[#c1dddb] ml-2 pl-4 pb-4 hover:border-[#5b9a94] group cursor-pointer">
                  <a href="data_cleaning.html#data" class="font-medium font-light leading-4 mb-2 group-hover:font-normal">Data I/O</a>
                </li>
                <li class="toc-dot flex flex-col relative border-l-2 border-[#c1dddb] ml-2 pl-4 pb-4 hover:border-[#5b9a94] group cursor-pointer">
                  <a href="data_cleaning.html#order" class="font-medium font-light leading-4 mb-2 group-hover:font-normal">Order</a>
                </li>
                <li class="toc-dot flex flex-col relative border-l-2 border-[#c1dddb] ml-2 pl-4 pb-4 hover:border-[#5b9a94] group cursor-pointer">
                  <a href="data_cleaning.html#subset" class="font-medium font-light leading-4 mb-2 group-hover:font-normal">Subset</a>
                </li>
                <li class="toc-dot flex flex-col relative border-l-2 border-[#c1dddb] ml-2 pl-4 pb-4 hover:border-[#5b9a94] group cursor-pointer">
                  <a href="data_cleaning.html#modify" class="font-medium font-light leading-4 mb-2 group-hover:font-normal">Modify</a>
                </li>
                <li class="toc-dot flex flex-col relative border-l-2 border-[#c1dddb] ml-2 pl-4 pb-4 hover:border-[#5b9a94] group cursor-pointer">
                  <a href="data_cleaning.html#collapse" class="font-medium font-light leading-4 mb-2 group-hover:font-normal">Collapse</a>
                </li>
                <li class="toc-dot flex flex-col relative border-l-2 border-[#c1dddb] ml-2 pl-4 pb-4 hover:border-[#5b9a94] group cursor-pointer">
                  <a href="data_cleaning.html#reshape" class="font-medium font-light leading-4 mb-2 group-hover:font-normal">Reshape</a>
                </li>
                <li class="toc-dot flex flex-col relative border-l-2 border-transparent ml-2 pl-4 pb-4 hover:border-transparent group cursor-pointer">
                  <a href="data_cleaning.html#merge" class="font-medium font-light leading-4 mb-2 group-hover:font-normal">Merge</a>
                </li>
              </ul>
            </div>
            <div>
              <h1 class="text-2xl font-semibold tracking-tight mt-8 text-[#315450]">
                <a href="regression.html">fixest</a>
              </h1>
              <ul class="mt-4 relative">
                <li class="toc-dot flex flex-col relative border-l-2 border-[#c1dddb] ml-2 pl-4 pb-4 hover:border-[#5b9a94] group cursor-pointer">
                  <a href="regression.html#formula" class="font-medium font-light leading-4 mb-2 group-hover:font-normal">Formula creation</a>
                </li>
                <li class="toc-dot flex flex-col relative border-l-2 border-[#c1dddb] ml-2 pl-4 pb-4 hover:border-[#5b9a94] group cursor-pointer">
                  <a href="regression.html#std_errors" class="font-medium font-light leading-4 mb-2 group-hover:font-normal">Standard errors</a>
                </li>
                <li class="toc-dot flex flex-col relative border-l-2 border-[#c1dddb] ml-2 pl-4 pb-4 hover:border-[#5b9a94] group cursor-pointer">
                  <a href="regression.html#post" class="font-medium font-light leading-4 mb-2 group-hover:font-normal">Postestimation</a>
                </li>
                <li class="toc-dot flex flex-col relative border-l-2 border-[#c1dddb] ml-2 pl-4 pb-4 hover:border-[#5b9a94] group cursor-pointer">
                  <a href="regression.html#panel" class="font-medium font-light leading-4 mb-2 group-hover:font-normal">Panel data</a>
                </li>
                <li class="toc-dot flex flex-col relative border-l-2 border-transparent ml-2 pl-4 pb-4 hover:border-transparent group cursor-pointer">
                  <a href="regression.html#iv" class="font-medium font-light leading-4 mb-2 group-hover:font-normal">Instrumental variables</a>
                </li>
              </ul>
            </div>
            <div>
              <h1 class="text-2xl font-semibold tracking-tight mt-8 text-[#315450]">
                <a href="misc.html">extras</a>
              </h1>
            </div>
            <div class="mt-8 flex flex-row gap-x-4 items-center">
              <a href="https://github.com/stata2r/stata2r.github.io"><svg class="w-6 h-6 text-[#5b9a94] fill-current" role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>GitHub</title><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"/></svg></a>
              <div class="flex flex-col">
                <p class="text-sm italic text-gray-600">Have suggestions?</p>
                <p class="text-sm text-gray-600">
                  <a href="https://github.com/stata2r/stata2r.github.io/issues/new">Open an issue üìù</a>
                </p>
              </div>
            </div>
          </div>
        </div>
        <div class="flex-grow min-h-screen py-16 pb-96">
          <div class="w-full mx-auto py-12">
            <div class="pb-4 border-b-2 border-gray-600">
              <h1 class="text-black text-4xl font-bold">Other Packages</h1>
            </div>
            <div class="flex flex-col gap-y-4 text-gray-800 pt-8 text-gray-700 text-lg md:text-xl xl:text-2xl">
              <p>
                While we think you can get pretty darn far in R with just 
                <span class="font-semibold">data.table</span>
                 and 
                <span class="font-semibold">fixest,</span>
                 of course those two don't cover everything.
              </p>
              <p>
                This page covers a small list of packages you may find especially useful when getting started with R. 
                We won't try to cover everything under the sun here. Just a few places to get going. For the rest, well, that's what Google is for (or, indeed, to learn about each of these in more detail).
              </p>
              <p>
                All of the below packages have far more applications than is shown here. We'll just provide one or two examples of how each can be used. Finally, don't forget to install them with 
                <span class="font-semibold">install.packages('PKGNAME')</span>
                 and load them with 
                <span class="font-semibold">library(PKGNAME)</span>
                . The former command you only have to run once per package (or as often as you want to update it); the latter whenever you want to use a package in a new R session.
              </p>
            </div>
          </div>
          <div id="ggplot">
            <div class="w-full mx-auto py-12">
              <div class="flex flex-row">
                <h2 class="inline-block font-bold text-2xl text-[#315450]">ggplot2: Beautiful and customizable plots</h2>
              </div>
              <div class="flex flex-col gap-y-4 text-gray-600 mt-6 text-lg md:text-xl xl:text-2xl"><p><a href = "https://ggplot2.tidyverse.org/" class="text-[#4c807b] font-semibold underline">ggplot2</a> is widely considered one of the preeminent plotting libraries available in any language. It provides an intuitive syntax that applies in the same way across many, many different kinds of vizualisations, and with a deep level of available customization. Plus, endless additional plugins to do what you want, including easy interactivity, animation, maps, etc. We thought about giving <span class="font-semibold">ggplot2</span> its own dedicated page like <span class="font-semibold">data.table</span> and <span class="font-semibold">fixest</span>. But instead we'll point you to the <span class="text-[#4c807b] font-semibold underline"><a  href = "https://lost-stats.github.io/Presentation/Figures/Figures.html">Figures</a></span> section of the Library of Statistical Techniques, which already shows how to do many different graphing tasks in both Stata and <span class="font-semibold">ggplot2</span>. For a more in-depth overview you can always consult the excellent <a href = "https://ggplot2.tidyverse.org/" class="text-[#4c807b] font-semibold underline">package documentation</a>, or a book like Kieran Healy's <span class="text-[#4c807b] font-semibold underline italic"><a href = "https://socviz.co/">Data Visualization</a></span>.</div>
              <div class="grid grid-cols-1 xl:grid-cols-2 xl:gap-x-8 justify-start gap-y-4 mt-8">
                <div class="xl:col-span-2">
                  <h2 class="text-gray-600 text-lg font-semibold">Basic scatterplot</h2>
                </div>
                <pre class="bg-white border-2 rounded-lg flex flex-col justify-start px-4 py-4">
                  <code class="language-stata">twoway scatter yvar xvar
* "Graphing the same thing separately across groups" is absurdly easier in ggplot2 than in Stata
 twoway (scatter yvar xvar if group == 1, mc(blue)) (scatter yvar xvar if group == 2, mc(red))</code>
                </pre>
                <pre class="bg-white border-2 rounded-lg flex flex-col justify-start px-4 py-4">
                  <code class="language-r">ggplot(dat, aes(x = xvar, y = yvar)) + geom_point()
# "Graphing the same thing separately across groups" is absurdly easier in ggplot2 than in Stata
ggplot(dat, aes(x = xvar, y = yvar, color = group)) + geom_point()</code>
                </pre>
              </div>
            </div>
          </div>
          <div id="tidyverse">
            <div class="w-full mx-auto py-12">
              <div class="flex flex-row">
                <h2 class="inline-block font-bold text-2xl text-[#315450]">tidyverse</h2>
              </div>
              <div class="flex flex-col gap-y-4 text-gray-600 mt-6 text-lg md:text-xl xl:text-2xl"><p>The <a href = "https://www.tidyverse.org" class="text-[#4c807b] font-semibold underline">tidyverse</a> provides an extremely popular framework for data science tasks in R. This meta-package is actually a collection of smaller packages that are all designed to work together, based on a shared philosophy and syntax. We've already covered <span class="font-semibold">ggplot2</span> above, but there are plenty more. These include <span class="font-semibold">dplyr</span> and <span class="font-semibold">tidyr</span>, which offer an alternative syntax and approach to data wrangling tasks.  While we personally recommend <span class="font-semibold">data.table</span>, these <span class="font-semibold">tidyverse</span> packages have many ardent fans too. You may find that you prefer their modular design and verbal syntax. But don't feel bound either way: it's totally fine to combine them. Some other tidyverse packages worth knowing about include <span class="font-semibold">purrr</span>, which contains a suite of functions for automating and looping your work, <span class="font-semibold">lubridate</span> which makes working with date-based data easy, and <span class="font-semibold">stringr</span> which offers functions with straightforward syntax for working with string variables.</p></div>
              <div class="grid grid-cols-1 xl:grid-cols-2 xl:gap-x-8 justify-start gap-y-4 mt-8">
                <div class="xl:col-span-2">
                  <h2 class="text-gray-600 text-lg font-semibold">Data wrangling with dplyr</h2>
                </div>
                <pre class="bg-white border-2 rounded-lg flex flex-col justify-start px-4 py-4">
                  <code class="language-stata">* Subset by rows and then columns 
keep if var1=="value" 
keep var1 var2 var3 


* Create a new variable by group 
bysort group1: egen mean_var1 = mean(var1) 



* Collapse by group 
collapse (mean) arr_delay, by(carrier)</code>
                </pre>
                <pre class="bg-white border-2 rounded-lg flex flex-col justify-start px-4 py-4">
                  <code class="language-r"># Subset by rows and then columns 
 dat %&gt;%   # `%&gt;%` is the tidyverse "pipe" operator
   filter(var1=="value") %&gt;%
   select(var1, var2, var3) 

# Create a new variable by group 
dat %&gt;% 
  group_by(group1) %&gt;% 
  mutate(mean_var1 = mean(var1)) 

# Collapse by group 
dat %&gt;% 
  group_by(group1) %&gt;% 
  summarise(mean_var1 = mean(var1)) 

# PS. dplyr doesn't modify data in place. So you'll need
# to (re)assign if you want to keep the above changes. 
# E.g. dat = dat %&gt;% group_by...</code>
                </pre>
              </div>
              <div class="grid grid-cols-1 xl:grid-cols-2 xl:gap-x-8 justify-start gap-y-4 mt-8">
                <div class="xl:col-span-2">
                  <h2 class="text-gray-600 text-lg font-semibold">Manipulating dates with lubridate</h2>
                </div>
                <pre class="bg-white border-2 rounded-lg flex flex-col justify-start px-4 py-4">
                  <code class="language-stata">* Shift a date forward one month (not 30 days, one month)
* ??? </code>
                </pre>
                <pre class="bg-white border-2 rounded-lg flex flex-col justify-start px-4 py-4">
                  <code class="language-r"># Shift a date forward one month (not 30 days, one month)
shifted_date = date + months(1)</code>
                </pre>
              </div>
              <div class="grid grid-cols-1 xl:grid-cols-2 xl:gap-x-8 justify-start gap-y-4 mt-8">
                <div class="xl:col-span-2">
                  <h2 class="text-gray-600 text-lg font-semibold">Iterating with purrr</h2>
                </div>
                <pre class="bg-white border-2 rounded-lg flex flex-col justify-start px-4 py-4">
                  <code class="language-stata">* Read in many files and append them together
local filelist: dir "Data/" files "*.dta"
local firsttime = 1
foreach f in filelist {
    use `f', clear
    if `firsttime' == 0 {
        append using compiled_data.dta
    }
    save compiled_data.dta, replace
}</code>
                </pre>
                <pre class="bg-white border-2 rounded-lg flex flex-col justify-start px-4 py-4">
                  <code class="language-r"># Read in many files and append them together
# (this combines purrr with the data.table function fread)
filelist = list.files('Data/', pattern = '.csv')
dat = filelist %&gt;%
    map_df(fread)</code>
                </pre>
              </div>
              <div class="grid grid-cols-1 xl:grid-cols-2 xl:gap-x-8 justify-start gap-y-4 mt-8">
                <div class="xl:col-span-2">
                  <h2 class="text-gray-600 text-lg font-semibold">String operations with stringr</h2>
                </div>
                <pre class="bg-white border-2 rounded-lg flex flex-col justify-start px-4 py-4">
                  <code class="language-stata">subinstr(string, "remove", "replace", .)
substr(string, start, length)
regex(string, "regex")</code>
                </pre>
                <pre class="bg-white border-2 rounded-lg flex flex-col justify-start px-4 py-4">
                  <code class="language-r">str_replace_all(string, "remove", "replace")
str_sub(string, start, end)
str_detect(string, "regex")
# Note all the stringr functions accept regex input</code>
                </pre>
              </div>
            </div>
          </div>
          <div id="collapse ">
            <div class="w-full mx-auto py-12">
              <div class="flex flex-row">
                <h2 class="inline-block font-bold text-2xl text-[#315450]">collapse: Extra convenience functions and super fast aggregations</h2>
              </div>
              <div class="flex flex-col gap-y-4 text-gray-600 mt-6 text-lg md:text-xl xl:text-2xl"><p>Sure, we've gone on and on about how fast <span class="font-semibold">data.table</span> is compared to just about everything else. But there is another R package that can boast even faster computation times for certain grouped calculations and transformations, and that's <a href = "https://sebkrantz.github.io/collapse/index.html" class="text-[#4c807b] font-semibold underline">collapse</a>. The <span class="font-semibold">collapse</span> package doesn't try to do everything that <span class="font-semibold">data.table</span> does. But the two <span class="text-[#4c807b] underline"><a href="https://sebkrantz.github.io/collapse/articles/collapse_and_data.table.html">play very well together</a></span> and the former offers some convenience functions like `descr` and `collap`, which essentially mimic the equivalent functions in Stata and might be particularly appealing to readers of this guide. (P.S. If you'd like to load <span class="font-semibold">data.table</span> and <span class="font-semibold">collapse</span> at the same time, plus some other high-performance packages, check out the <a href = "https://sebkrantz.github.io/fastverse/index.html" class="text-[#4c807b] font-semibold underline">fastverse</a>.)</p></div>
              <div class="grid grid-cols-1 xl:grid-cols-2 xl:gap-x-8 justify-start gap-y-4 mt-8">
                <div class="xl:col-span-2">
                  <h2 class="text-gray-600 text-lg font-semibold">Quick summaries</h2>
                </div>
                <pre class="bg-white border-2 rounded-lg flex flex-col justify-start px-4 py-4">
                  <code class="language-stata">summarize
describe</code>
                </pre>
                <pre class="bg-white border-2 rounded-lg flex flex-col justify-start px-4 py-4">
                  <code class="language-r">qsu(dat)
descr(dat)</code>
                </pre>
              </div>
              <div class="grid grid-cols-1 xl:grid-cols-2 xl:gap-x-8 justify-start gap-y-4 mt-8">
                <div class="xl:col-span-2">
                  <h2 class="text-gray-600 text-lg font-semibold">Multiple grouped aggregations</h2>
                </div>
                <pre class="bg-white border-2 rounded-lg flex flex-col justify-start px-4 py-4">
                  <code class="language-stata">collapse (mean) var1, by(group1)
collapse (min) min_var1=var1 min_var2=var2 (max) max_var1=var1 max_var2=var2, by(group1 group2)</code>
                </pre>
                <pre class="bg-white border-2 rounded-lg flex flex-col justify-start px-4 py-4">
                  <code class="language-r">collap(dat, var1 ~ group1, fmean) # 'fmean' =&gt; fast mean
collap(dat, var1 + var2 ~ group1 + group2, FUN = list(fmin, fmax))</code>
                </pre>
              </div>
            </div>
          </div>
          <div id="sandwich">
            <div class="w-full mx-auto py-12">
              <div class="flex flex-row">
                <h2 class="inline-block font-bold text-2xl text-[#315450]">sandwich: More standard error adjustments</h2>
              </div>
              <div class="flex flex-col gap-y-4 text-gray-600 mt-6 text-lg md:text-xl xl:text-2xl"><p>The <span class="font-semibold">fixest</span> package comes with plenty of shortcuts for accessing standard-error adjustments like HC1 heteroskedasticity-robust standard errors, Newey-West, Driscoll-Kraay, or clustered standard errors. But there are, of course, many more than that. A host of additional options are covered by the <a href = "https://sandwich.r-forge.r-project.org/articles/sandwich.html" class="text-[#4c807b] font-semibold underline">sandwich</a> package, which comes with a long list of functions like <span class="font-semibold">vcovBS()</span> for bootstrapped standard errors, or <span class="font-semibold">vcovHC()</span> for HC1-5. These can slot right into <span class="font-semibold">fixest</span> estimates, too. You shouldn't be using those `, robust` errors for smaller samples anyway... but you <a href = "http://datacolada.org/99" class="text-[#4c807b] underline">knew that</a>, right?</p></div>
              <div class="grid grid-cols-1 xl:grid-cols-2 xl:gap-x-8 justify-start gap-y-4 mt-8">
                <div class="xl:col-span-2">
                  <h2 class="text-gray-600 text-lg font-semibold">Linear model adjustments</h2>
                </div>
                <pre class="bg-white border-2 rounded-lg flex flex-col justify-start px-4 py-4">
                  <code class="language-stata">* ", robust" uses hc1 which isn't great for small samples
regress Y X Z, vce(hc3)</code>
                </pre>
                <pre class="bg-white border-2 rounded-lg flex flex-col justify-start px-4 py-4">
                  <code class="language-r"># sandwich's vcovHC uses HC3 by default
feols(Y ~ X + Z, dat,vcov = sandwich::vcovHC) 

# Aside: Remember that you can also adjust the SEs 
# for existing models on the fly 
m = feols(Y ~ X + Z, dat) 
summary(m, vcov = sandwich::vcovHC)</code>
                </pre>
              </div>
            </div>
          </div>
          <div id="modelsummary">
            <div class="w-full mx-auto py-12">
              <div class="flex flex-row">
                <h2 class="inline-block font-bold text-2xl text-[#315450]">modelsummary: Summary tables, regression tables, and more</h2>
              </div>
              <div class="flex flex-col gap-y-4 text-gray-600 mt-6 text-lg md:text-xl xl:text-2xl"><p>The <span class="font-semibold">fixest</span> package already has the <span class="font-semibold">etable()</span> function for generating regression tables. However, it is only really intended to work with models from the same package. So we also recommend checking out the fantastic <a href = "https://vincentarelbundock.github.io/modelsummary/" class="text-[#4c807b] font-semibold underline">modelsummary</a> package. It works with all sorts of model objects, including those not from <span class="font-semibold">fixest</span>, is incredibly customizable, and outputs to a bunch of different formats (PDF, HTML, DOCX, etc). Similarly, <span class="font-semibold">modelsummary</span> has a wealth of options for producing publication-ready summary tables. Oh, and it produces coefficient plots too. Check out the <a href = "https://vincentarelbundock.github.io/modelsummary/" class="text-[#4c807b] font-semibold underline">package website</a> for more.</p></div>
              <div class="grid grid-cols-1 xl:grid-cols-2 xl:gap-x-8 justify-start gap-y-4 mt-8">
                <div class="xl:col-span-2">
                  <h2 class="text-gray-600 text-lg font-semibold">Summary tables</h2>
                </div>
                <pre class="bg-white border-2 rounded-lg flex flex-col justify-start px-4 py-4">
                  <code class="language-stata">* Summary stats table 
estpost summarize 
esttab, cells("count mean sd min max") nomtitle nonumber 

* Balance table 
by treat_var: eststo: estpost summarize 
esttab, cells("mean sd") label nodepvar</code>
                </pre>
                <pre class="bg-white border-2 rounded-lg flex flex-col justify-start px-4 py-4">
                  <code class="language-r"># Summary stats table 
datasummary_skim(dat) 


# Balance table 
datasummary_balance(~treat_var, dat)</code>
                </pre>
              </div>
              <div class="grid grid-cols-1 xl:grid-cols-2 xl:gap-x-8 justify-start gap-y-4 mt-8">
                <div class="xl:col-span-2">
                  <h2 class="text-gray-600 text-lg font-semibold">Regression tables</h2>
                </div>
                <pre class="bg-white border-2 rounded-lg flex flex-col justify-start px-4 py-4">
                  <code class="language-stata">reg Y X Z 
eststore est1 
esttab est1b

reg Y X Z, vce(hc3) 
eststore est1b 
esttab est1b 

esttab est1 est1b

reg Y X Z A, vce(hc3)
eststore est2
esttab est1 est1b est2</code>
                </pre>
                <pre class="bg-white border-2 rounded-lg flex flex-col justify-start px-4 py-4">
                  <code class="language-r">est1 = lm(Y ~ X + Z, dat) 
msummary(est1) # msummary() = alias for modelsummary()

# Like fixest::etable(), SEs for existing models can
# be adjusted on-the-fly 
msummary(est1, vcov='HC3')

# Multiple SEs for the same model
msummary(est1, vcov=list('iid', 'HC3')) 

est3 = lm(Y ~ X + Z + A, dat) 
msummary(list(est1, est1, est3),
         vcov = list('iid', 'HC3', 'HC3'))</code>
                </pre>
              </div>
            </div>
          </div>
          <div id="lme4">
            <div class="w-full mx-auto py-12">
              <div class="flex flex-row">
                <h2 class="inline-block font-bold text-2xl text-[#315450]">lme4: Random effects and mixed models</h2>
              </div>
              <div class="flex flex-col gap-y-4 text-gray-600 mt-6 text-lg md:text-xl xl:text-2xl"><p><span class="font-semibold">fixest</span> can do a lot, but it can't do everything. This site isn't even going to attempt to go into how to translate every single model into R. But we'll quick highlight random-effects and mixed models. The <a href = "https://cran.r-project.org/web/packages/lme4/index.html" class="text-[#4c807b] font-semibold underline">lme4</a> package and its <span class="font-semibold">lmer()</span> function covers not just random-intercept models but also hierarchical models where slope coefficients follow random distributions. (<span class="font-semibold">Aside:</span> If you prefer Bayesian models for this kind of thing, check out the <a href = "https://paul-buerkner.github.io/brms/" class="text-[#4c807b] font-semibold underline">brms</a> package.)</p></div>
              <div class="grid grid-cols-1 xl:grid-cols-2 xl:gap-x-8 justify-start gap-y-4 mt-8">
                <div class="xl:col-span-2">
                  <h2 class="text-gray-600 text-lg font-semibold">Random effects and mixed models</h2>
                </div>
                <pre class="bg-white border-2 rounded-lg flex flex-col justify-start px-4 py-4">
                  <code class="language-stata">xtset group time
xtreg Y X, re
mixed lifeexp || countryn: gdppercap</code>
                </pre>
                <pre class="bg-white border-2 rounded-lg flex flex-col justify-start px-4 py-4">
                  <code class="language-r"># No need for an xtset equivalent
m = lmer(Y~(1|group) + X, dat)
nm = lmer(Y~(1+x|group) + X, dat)</code>
                </pre>
              </div>
            </div>
          </div>
          <div id="marginaleffects">
            <div class="w-full mx-auto py-12">
              <div class="flex flex-row">
                <h2 class="inline-block font-bold text-2xl text-[#315450]">marginaleffects: Marginal effects, constrasts, etc.</h2>
              </div>
              <div class="flex flex-col gap-y-4 text-gray-600 mt-6 text-lg md:text-xl xl:text-2xl"><p>The Stata <span class="font-semibold">margins</span> command is great. To replicate it in R, we recommend the <a href = "https://vincentarelbundock.github.io/marginaleffects/" class="text-[#4c807b] font-semibold underline">marginaleffects</a> package. Individual marginal effects or average marginal effects for nonlinear models, or models with interactions or transformations, etc. It's also very fast.</p></div>
              <div class="grid grid-cols-1 xl:grid-cols-2 xl:gap-x-8 justify-start gap-y-4 mt-8">
                <div class="xl:col-span-2">
                  <h2 class="text-gray-600 text-lg font-semibold">Basic logit marginal effects</h2>
                </div>
                <pre class="bg-white border-2 rounded-lg flex flex-col justify-start px-4 py-4">
                  <code class="language-stata">* A logit:
logit Y X Z
margins, dydx(*)</code>
                </pre>
                <pre class="bg-white border-2 rounded-lg flex flex-col justify-start px-4 py-4">
                  <code class="language-r"># This example incorporates the fixest function feglm()
m = feglm(Y ~ X + Z, family = binomial, data = mtcars)
summary(marginaleffects(m))</code>
                </pre>
              </div>
            </div>
          </div>
          <div id="multcomp">
            <div class="w-full mx-auto py-12">
              <div class="flex flex-row">
                <h2 class="inline-block font-bold text-2xl text-[#315450]">multcomp and nlWaldTest: Joint coefficient tests</h2>
              </div>
              <div class="flex flex-col gap-y-4 text-gray-600 mt-6 text-lg md:text-xl xl:text-2xl"><p>Stata provides a number of inbuilt commands for (potentially complex) postestimation coefficient tests like <span class="font-semibold">testparm</span>, <span class="font-semibold">lincom</span>, and <span class="font-semibold">nlcom</span>. We've already seen that <span class="font-semibold">fixest</span> covers the <span class="font-semibold">testparm</span> equivalent with its <span class="font-semibold">wald()</span> function. But what about combinations of coefficients? The <a href = "http://multcomp.r-forge.r-project.org/" class="text-[#4c807b] font-semibold underline">multcomp</a> package handles a variety of linear tests and combinations, while <a href = "https://cran.r-project.org/web/packages/nlWaldTest/index.html" class="text-[#4c807b] font-semibold underline">nlWaldTest</a> has you covered for nonlinear combinations.</p></div>
              <div class="grid grid-cols-1 xl:grid-cols-2 xl:gap-x-8 justify-start gap-y-4 mt-8">
                <div class="xl:col-span-2">
                  <h2 class="text-gray-600 text-lg font-semibold">Test other null hypotheses and coefficient combinations</h2>
                </div>
                <pre class="bg-white border-2 rounded-lg flex flex-col justify-start px-4 py-4">
                  <code class="language-stata">
regress y x z 




* One-sided test 
test _b[x]=0 
local sign_wgt = sign(_b[x]) 
display "H0: coef &lt;= 0  p-value = " ttail(r(df_r),`sign_wgt'*sqrt(r(F))) 

* Test linear combination of coefficients 
lincom x + z 


* Test nonlinear combination of coefficients 
nlcom _b[x]/_b[z]</code>
                </pre>
                <pre class="bg-white border-2 rounded-lg flex flex-col justify-start px-4 py-4">
                  <code class="language-r">m = feols(y ~ x + z, dat)

# Note: we recommend the dev version of multcomp 
# install.packages("multcomp", repos="http://R-Forge.R-project.org") 

# One-sided test 
m2 = multcomp::ghlt(m, 'x&lt;=0')
summary(m2) 


# Test linear combination of coefficients 
m3 = multcomp::glht(m, 'x + z = 0') 
summary(m3) # or confint(m3) 

# Test nonlinear combination of coefficients 
nlWaldtest::nlWaldtest(m, 'b[2]/b[3]') # or nlWaldtest::nlConfint()</code>
                </pre>
              </div>
            </div>
          </div>
          <div id="sf">
            <div class="w-full mx-auto py-12">
              <div class="flex flex-row">
                <h2 class="inline-block font-bold text-2xl text-[#315450]">sf: Geospatial operations</h2>
              </div>
              <div class="flex flex-col gap-y-4 text-gray-600 mt-6 text-lg md:text-xl xl:text-2xl"><p>R has outstanding support for geospatial computation and mapping. There are a variety of packages to choose from here, depending on what you want (e.g. interactive maps, high-dimensional data cubes, etc.) But the workhorse geospatial tool for most R users is the incredibly versatile <a href = "https://r-spatial.github.io/sf/" class="text-[#4c807b] font-semibold underline">sf</a> package. We'll only provide a simple mapping example below. The <span class="font-semibold">sf</span> <a href = "https://r-spatial.github.io/sf/" class="text-[#4c807b] underline">website</a> has several in-depth tutorials, and we also recommend the <span class="text-[#4c807b] font-semibold underline italic"><a href = "https://geocompr.robinlovelace.net/">Geocomputation with R</a></span> book by Robin Lovelace, Jakub Nowosad, and Jannes Muenchow.</p></div>
              <div class="grid grid-cols-1 xl:grid-cols-2 xl:gap-x-8 justify-start gap-y-4 mt-8">
                <div class="xl:col-span-2">
                  <h2 class="text-gray-600 text-lg font-semibold">Simple map</h2>
                </div>
                <pre class="bg-white border-2 rounded-lg flex flex-col justify-start px-4 py-4">
                  <code class="language-stata">* Mapping in Stata requires the spmap and shp2dta 
* commands, and also that you convert your (say) 
* shapefile to .dta format first. We won't go through 
* all that here, but see: 
* https://www.stata.com/support/faqs/graphics/spmap-and-maps/</code>
                </pre>
                <pre class="bg-white border-2 rounded-lg flex flex-col justify-start px-4 py-4">
                  <code class="language-r"># This example uses the North Carolina shapefile that is
# bundled with the sf package. 
nc = st_read(system.file("shape/nc.shp", package = "sf")) 
plot(nc[, 'BIR74'])
# Or, if you have ggplot2 loaded: 
ggplot(nc, aes(fill=BIR74)) + geom_sf()</code>
                </pre>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</body>